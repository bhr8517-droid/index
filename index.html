<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>#شهروند_مطالبه_گر</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  direction:rtl;
  font-family:tahoma;
  background: linear-gradient(135deg, #d9f0ff, #ffffff);
  margin:0;
  padding:0;
}

/* هدر لوگو با اندازه واقعی تصویر */
.header{
  width:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#1976d2;
  padding:0;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
}

.header img{
  max-width:100%;
  height:auto;
  display:block;
  object-fit: contain;
}

/* فرم */
.box{
  width:90%;
  max-width:600px;
  margin:20px auto 50px auto;
  background:#ffffff;
  padding:25px;
  border-radius:12px;
  box-shadow:0 10px 20px rgba(0,0,0,0.1);
  transition:0.3s;
}

.box:hover{
  transform: translateY(-2px);
}

input,textarea{
  width:100%;
  padding:10px;
  margin-top:8px;
  margin-bottom:16px;
  border-radius:6px;
  border:1px solid #ccc;
  transition:0.3s;
  font-size:16px;
}

input:focus, textarea:focus{
  border-color:#1976d2;
  box-shadow:0 0 8px rgba(25,118,210,0.3);
}

textarea{
  height:160px;
}

button{
  width:100%;
  padding:14px;
  background: linear-gradient(135deg,#1976d2,#4a90e2);
  color:#fff;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:16px;
  transition:0.3s;
}

button:hover{
  background: linear-gradient(135deg,#4a90e2,#1976d2);
  transform: scale(1.03);
  box-shadow:0 6px 15px rgba(0,0,0,0.2);
}

#status{
  margin-top:15px;
  font-size:14px;
  color:#1976d2;
}

.footer{
  margin-top:25px;
  font-size:13px;
  color:#555;
  text-align:center;
}

/* Media Queries برای موبایل */
@media (max-width:480px){
  .box{
    padding:20px;
  }
  input,textarea{
    font-size:14px;
    padding:8px;
  }
  button{
    font-size:15px;
    padding:12px;
  }
  .footer{
    font-size:12px;
  }
}

</style>
</head>
<body>

<div class="header">
  <img src="https://361iran.ir/wp-content/uploads/2021/01/%D8%AE%D8%B7-%D8%AD%D8%B2%D8%A8-%D8%A7%D9%84%D9%84%D9%87.jpg" alt="لوگو بنر">
</div>

<div class="box">
  <h3>#شهروند_مطالبه_گر</h3>

  <input id="name" placeholder="نام و نام خانوادگی">
  <input id="title" placeholder="عنوان / سمت فرستنده">
  <textarea id="message" placeholder="متن پیام خطاب به مسئولین"></textarea>

  <div id="captchaText"></div>
  <input id="captchaAnswer" placeholder="پاسخ کپچا">

  <button onclick="send()">ارسال پیام</button>
  <div id="status"></div>

  <div class="footer">
    تمامی حقوق برگزاری این پویش متعلق به کانال خبری نسیم آنلاین می‌باشد
  </div>
</div>

<script>
const WORKER_URL = "https://nsim1404.bhr8517.workers.dev/";

const a = Math.floor(Math.random()*10)+1;
const b = Math.floor(Math.random()*10)+1;
document.getElementById("captchaText").innerText =
"کپچا: " + a + " + " + b + " = ؟";

function genCode(){
  return "PX-" + Math.random().toString(16).slice(2,8).toUpperCase();
}

async function send(){
  const name = document.getElementById("name").value.trim();
  const title = document.getElementById("title").value.trim();
  const message = document.getElementById("message").value.trim();
  const answer = document.getElementById("captchaAnswer").value.trim();
  const status = document.getElementById("status");

  if(!name || !title || !message || !answer){
    status.innerText = "همه فیلدها الزامی است";
    return;
  }

  if(Number(answer) !== a + b){
    status.innerText = "پاسخ کپچا نادرست است";
    return;
  }

  const code = genCode();

  try{
    const res = await fetch(WORKER_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ name,title,message,code })
    });

    if(res.ok){
      status.innerHTML =
      "✅ پیام ارسال شد<br>کد پیگیری: <b>"+code+"</b>";
      document.getElementById("message").value="";
    }else{
      status.innerText="خطا در ارسال پیام";
    }
  }catch(e){
    status.innerText="عدم اتصال به سرور";
  }
}
</script>

</body>
</html>
